# 마이크로서비스 도출 기법

- 모듈화의 근본 가치는 각 모듈을 기능적으로 응집성 높게 만들고(high cohesion), 기능이 타 모듈 간에 의존도를 낮추는 것(low coupling).
- 마이크로서비스도 마찬가지로 응집성 있는 마이크로서비스를 도출하고 서비스 간의 의존도를 낮춰야 함.
- 추가로 그렇게 식별한 마이크로서비스의 내부구조의 각 요소들도 모듈화 되어야 함.

![마이크로서비스 도출 기법](https://engineering-skcc.github.io/assets/images/msa/MSA5.1.png)

## 비즈니스 능력에 근거한 도출

- 마이크로서비스를 식별하는 가장 쉬운 방법으로 경험적인 원칙을 적용하는 것.
- 각 도메인에서는 비즈니스가 규정하는 일하는 방식과 조직, 부서 체계가 이미 정의되어 있고, 이러한 부서는 이미 업무 처리에서의 응집성을 가지고 있고 타 부서와의 의존도는 낮을 것.
- 비즈니스 부서가 가진 역할, 처리 능력을 체계적으로 분해(업무 기능 분해)하여 업무를 최상위에서 하위까지 대, 중, 소 크기로 분리하고 수행하는 일들을 체계적으로 정렬.
- 이러한 방식은 전체적인 대략의 비즈니스를 이해할 때는 유용하지만 서비스 간의 관계를 파악하거나 서비스의 구체 기능과 연관된 서비스가 관리할 독립적인 데이터를 식별하기에는 미흡.

![비즈니스 능력에 근거한 도출](https://engineering-skcc.github.io/assets/images/msa/MSA5.2.png)

## DDD의 바운디드 컨텍스트 기반 도출

- 마이크로서비스는 각 저장소를 독립적으로 보유하고, 각 데이터는 다른 서비스에서 직접 참조해서는 안되는 특성이 있음.
- 따라서 마이크로서비스를 도출할 때 서비스가 소유권을 가진 데이터를 독립적으로 식별하는 것이 중요. 서비스가 보유한 기능에 의해서만 접근 가능한(캡슐화) 데이터를 파악할 필요가 있음.
- DDD에서는 데이터를 기능과 분리해서 식별하지 않고 문제 영역인 하위 도메인마다 별도의 도메인 모델로 정의함. 도메인 모델은 각 업무에 특화된 유비쿼터스 언어로 정의되고, 그 업무에 특화된 개념으로 구성됨.
- 이러한 특성에 기반해 도메인 모델을 소유한 바운디드 컨텍스트 중심으로 마이크로서비스를 도출하는 가이드로 사용될 수 있음.

![DDD의 바운디드 컨텍스트 기반 도출](https://engineering-skcc.github.io/assets/images/msa/MSA5.3.png)

### 마이크로서비스는 얼마나 작아야 하나?

- 마이크로서비스의 크기는 코드의 크기처럼 양적(quantity)으로 판단할 것이 아니라 전체 업무 맥락에서 질적(quality)으로 판단해야 함.
- 질적 판단 요소는 자율적으로 수행 가능한 업무의 단위, 개념의 일관성이나 기능의 응집성 등을 말하며, 이는 비즈니스 도메인이나 조직의 성숙도에 따라 상대적.
