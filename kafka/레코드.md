# 레코드

레코드는 타임스탬프, 메시지 키, 메시지 값, 오프셋, 헤더로 구성. 프로듀서가 생성한 레코드가 브로커로 전송되면 오프셋과 타임스탬프가 지정되어 저장됨. 브로커에 한번 적재된 레코드는 수정할 수 없고 로그 리텐션 기간 또는 용량에 따라서만 삭제됨.

## 타임스탬프

타음스탬프는 프로듀서에서 해당 레코드가 생성된 시점(CreateTime)의 유닉스 타임이 설정됨.

컨슈머는 레코드의 타임스탬프를 토대로 레코드가 언제 생성되었는지 알 수 있음. 단 프로듀서가 레코드를 생성할 때 임의의 타임스탬프 값을 설정할 수 있고, 토픽 설정에 따라 브로커에 적재된 시간(LogAppendTime)으로 설정될 수도 있다는 점을 유의.

## 메시지 키

메시지 키는 메시지 값을 순서대로 처리하거나 메시지 값의 종류를 나타내기 위해 사용.

메시지 키를 사용하면 프로듀서가 토픽에 레코드를 전송할 때 메시지 키의 해시값을 토대로 파티션을 지정하게 되며, 동일한 메시지 키는 동일 파티션에 들어감. 단 어느 파티션에 지정될지 알 수 없고 파티션 개수가 변경되면 메시지 키와 파티션 매칭이 달라지게 되므로 주의.

메시지 키를 선언하지 않으면 null로 설정되며 프로듀서 기본 설정 파티셔너에 따라서 파티션에 분배되어 적재됨.

## 메시지 값

메시지 값에는 실질적으로 처리할 데이터가 들어 있음.

메시지 키와 메시지 값은 직렬화되어 브로커로 전송되기 때문에 컨슈머가 이용할 때는 동일한 형태로 역직렬화를 수행해야 함.

레코드의 오프셋은 0 이상의 숫자로 이루어져 있음. 레코드의 오프셋은 직접 지정할 수 없고 브로커에 저장될 때 이전에 전송된 레코드의 오프셋+1 값으로 생성됨. 오프셋은 카프카 컨슈머가 데이터를 가져갈 때 데이터를 어디까지 가져갔는지 파악할 때 사용됨.

## 헤더

헤더는 레코드의 추가적인 정보를 담는 메타데이터 저장소 용도로 사용함.

헤더는 키/값 형태로 데이터를 추가하여 레코드의 속성(스키마 버전 등)을 저장하여 컨슈머에서 참조할 수 있음.
