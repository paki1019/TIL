REDIS는 다음 특징을 갖는 data structure
1. Remote 에 위치
2. 프로세스로 존재
3. In-Memory: 메모리 기반
4. “키-값” 구조 데이터 관리 시스템: 비 관계형이며, 키-값 구조이기 때문에 별도 쿼리 없이도 데이터를 간단히 가져올 수 있음.

# 캐시를 사용할 때
서비스 사용자가 증가했을 때, 모든 유저의 요청을 DB 접근으로만 처리하게 된다면 DB 서버에 무리가 감.

이런 맥락에서 캐시는 나중에 요청된 결과를 미리 저장해두었다가 빨리 제공하기 위해 사용

보통 우리가 사용하는 Redis Cache 는 메모리 단 (In-Memory) 에 위치. 따라서 디스크보다 수용력(용량) 은 적지만 접근 속도는 빠름.

## Look aside cache
![Look aside cache](https://media.vlpt.us/images/hyeondev/post/d13edf64-100b-412c-a5ea-af0c80ef2147/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202020-10-03%20%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB%201.07.33.png)
1. 웹 서버는 클라이언트 요청을 받아서, 데이터가 존재하는지 캐시를 먼저 확인
2. Cache에 데이터가 있으면 그걸 꺼내줌
3. 만약 Cache에 데이터가 없으면 DB 에서 읽어서 -> 먼저 캐시에 저장한다음 클라이언트에게 데이터를 돌려줌

## Write Back
- 데이터를 캐시에 전부 먼저 저장해놓았다가 특정 시점마다 한번씩 캐시 내 데이터를 DB insert 하는 방법
- insert 를 1개씩 500번 수행하는 것보다 500개를 한번에 삽입하는 동작이 훨씬 빠름
- 데이터를 일정 기간동안 메모리 공간에 유지해야 하는데 서버 장애 상황에서 데이터가 손실될 수 있다는 단점이 있음.
- 다시 재생 가능한 데이터나, 극단적으로 heavy 한 데이터에서 write back 방식을 많이 사용

# Redis 는 어떤 특징을 가지고 있을까
캐시로 많이 사용하는 Memcached 와 Redis 의 가장 큰 차이는 Collection 을 제공하냐의 여부, Redis 에서는 Collection 을 제공
- 대상 사용자가 많은 경우 랭킹을 산출하는 서버를 구현
  - Redis 의 Sorted Set 을 사용하면 랭킹 서버를 쉽게 구현 가능하며 replication 까지도 가능
  - 단 용량 한계에 종속적이 됨.
- 친구 리스트를 관리할 때 데이터를 key-value 형태로 저장
    - Redis 자료구조는 Atomic 하다는 특징 때문에 `race condition` 같은 이슈를 피할 수 있음.
    - Redis Transaction 은 한번의 딱 하나의 명령만 수행할 수 있으며, `single-threaded` 특성을 유지하기 때문에 다른 스토리지 플랫폼보다는 이슈가 덜함.

따라서 레디스는 remote data storage 로서 여러 서버에서 같은 데이터를 공유하고 보고싶을 때 많이 사용

# Redis Collection
1. String: 가장 일반적인 형태로, key - value 로 저장하는 형태 
2. Set: 중복된 데이터를 담지 않기 위해 사용하는 자료구조. 중복된 데이터를 여러번 저장하면 최종 한번만 저장됨
3. List: Array 형식의 데이터 구조. List 를 사용하면 처음과 끝에 데이터를 넣고 빼는건 속도가 빠르지만 중간에 데이터를 삽입하거나 삭제하는건 어려움이 있음.
4. Sorted Set: 유저 랭킹 보드서버 같은 구현에서 사용할 수 있음.

Collection 사용시 주의점
- 하나의 컬렉션에 너무 많은 아이템을 담으면 좋지 않음. 가능하면 10000개 이하, 몇천개 수준의 데이터셋을 유지하는게 Redis 성능에 영향주지 않음.
- Expire 은 Collection 의 아이템 개별로 걸리지않고, 전체 Collection 에 대해서만 걸림. 10000 개의 아이템을 가진 Collection 에 expire 가 걸려있다면, 그 시간 이후에 10000 개의 아이템이 모두 삭제됨.
